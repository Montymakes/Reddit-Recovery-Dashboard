{% extends 'base.html' %}

{% block head %}

{% endblock %}

{% block body %}

<div class="container-fluid m-4" ">
  <div class="row">
    <!-- <div class="col-md-4 chartbox">
      <canvas id="myChart" style="width:100%;max-width:500px"></canvas>
    </div> -->
    <!-- <div class="col-md-3">
      <canvas id="pieChart1" style="width:100%;max-width:500px"></canvas>
    </div> -->
  </div>
</div>
<div class="container rounded shadow p-2 mb-5 bg-light">
  
  <div class="row">
    <div class="col-md-12 text-center">
      <h3>Some Stats</h3>
    </div>
    <div class="col">
      <div class="col-md-3 float-end">
        <canvas id="pieChart1" style="width:100%; max-width: 10em;"></canvas>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="col-md-4 chartbox float-end">
        <canvas id="myChart" style="width:100%;max-width:500px"></canvas>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block scripts %}


<script type=text/javascript>
    var dict = JSON.parse('{{  jsdict  | tojson | safe  }}')
    var topSubs = JSON.parse('{{  topSubs  | tojson | safe  }}')
    // var xValues = Object.keys(dict)
    // var yValues = Object.values(dict)
    dict = {
        'Sunday': dict.Sunday,
        'Monday': dict.Monday,
        'Tuesday': dict.Tuesday,
        'Wednesday': dict.Wednesday,
        'Thursday': dict.Thursday,
        'Friday': dict.Friday,
        'Saturday': dict.Saturday

    }
    const labels = Object.keys(dict)

  const data = {
    labels: labels,
    datasets: [{
      label: 'What days do I post the most?',
      backgroundColor: 'rgb(255, 99, 132)',
      borderColor: 'rgb(255, 99, 132)',
      data: Object.values(dict),
    }]
  };

  const config = {
    type: 'bar',
    data: data,
    options: {

    }
  };

  const myChart = new Chart(
    document.getElementById('myChart'),
    config
  );

const entries = Object.entries(topSubs)
entries.sort(function(a, b){
    if(a[1] < b[1]) { return 1; }
    if(a[1] > b[1]) { return -1; }
    return 0;
})

subsArray = []
countsArray = []
for (let i = 0; i < 10; i++) {
  subsArray.push(entries[i][0]);
  countsArray.push(entries[i][1]);
}

// console.log(entries)
//all I need to do here is make two lists out of the value pairs to replace
//the labels and data. only take the first 10 values

  const dataPie = {
  labels: subsArray,
  datasets: [{
    label: 'My First Dataset',
    data: countsArray,
    backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)'
    ],
    hoverOffset: 4
  }]
};

const configPie = {
  type: 'pie',
  data: dataPie,
  options: {
    plugins:{
      legend:{
        display: false
      }
    }
  }
};

const pieChart1 = new Chart(
    document.getElementById('pieChart1'),
    configPie
  );
</script>

{% endblock %}